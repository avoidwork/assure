{"version":3,"sources":["assure.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","each","obj","fn","nth","call","pipe","parent","child","then","arg","resolve","e","reject","valid","isResolved","isRejected","deferred","undefined","promise","delay","process","nextTick","setImmediate","setTimeout","state","PENDING","FAILURE","SUCCESS","Promise","this","handlers","value","success","slice","callback","result","_this","_this2","failure","_this3","push","Deferred","onDone","onAlways","onFail","bootstrap","_this4","listeners","array","reset","when","_len","arguments","args","Array","_key","defer","p","map","exports","module","define","assure","window"],"mappings":"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","file":"assure.min.js","sourcesContent":["\"use strict\";\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * assure\r\n *\r\n * @copyright 2015 Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @license BSD-3-Clause\r\n * @link http://avoidwork.github.io/assure/\r\n * @version 1.1.0\r\n */\n(function (global) {\n\tvar deferred = undefined,\n\t    promise = undefined;\n\n\tvar delay = (function () {\n\t\tif (typeof process !== \"undefined\") {\n\t\t\treturn process.nextTick;\n\t\t} else if (typeof setImmediate !== \"undefined\") {\n\t\t\treturn setImmediate;\n\t\t} else {\n\t\t\treturn function (arg) {\n\t\t\t\tsetTimeout(arg, 0);\n\t\t\t};\n\t\t}\n\t})();\n\n\tfunction each(obj, fn) {\n\t\tvar nth = obj.length;\n\t\tvar i = -1;\n\n\t\twhile (++i < nth) {\n\t\t\tif (fn.call(obj, obj[i], i) === false) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tfunction pipe(parent, child) {\n\t\treturn parent.then(function (arg) {\n\t\t\tchild.resolve(arg);\n\t\t}, function (e) {\n\t\t\tchild.reject(e);\n\t\t});\n\t}\n\n\tvar state = {\n\t\tPENDING: 0,\n\t\tFAILURE: 1,\n\t\tSUCCESS: 2\n\t};\n\n\tfunction valid(obj, fn) {\n\t\treturn !obj.isResolved() && !obj.isRejected() && typeof fn === \"function\";\n\t}\n\n\t/**\r\n  * @class Promise\r\n  * @private\r\n  */\n\n\tvar Promise = (function () {\n\t\tfunction Promise() {\n\t\t\t_classCallCheck(this, Promise);\n\n\t\t\tthis.deferred = false;\n\t\t\tthis.handlers = [];\n\t\t\tthis.state = state.PENDING;\n\t\t\tthis.value = null;\n\t\t}\n\n\t\t_createClass(Promise, [{\n\t\t\tkey: \"process\",\n\t\t\tvalue: function process() {\n\t\t\t\tvar success = undefined,\n\t\t\t\t    value = undefined;\n\n\t\t\t\tthis.deferred = false;\n\n\t\t\t\tif (this.state !== state.PENDING) {\n\t\t\t\t\tvalue = this.value;\n\t\t\t\t\tsuccess = this.state === state.SUCCESS;\n\n\t\t\t\t\teach(this.handlers.slice(), function (i) {\n\t\t\t\t\t\tvar callback = i[success ? \"success\" : \"failure\"],\n\t\t\t\t\t\t    child = i.promise,\n\t\t\t\t\t\t    result = undefined;\n\n\t\t\t\t\t\tif (!callback || typeof callback !== \"function\") {\n\t\t\t\t\t\t\tif (value && typeof value.then === \"function\") {\n\t\t\t\t\t\t\t\tpipe(value, child);\n\t\t\t\t\t\t\t} else if (success) {\n\t\t\t\t\t\t\t\tchild.resolve(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.reject(value);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresult = callback(value);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tchild.reject(e);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (result && typeof result.then === \"function\") {\n\t\t\t\t\t\t\tpipe(result, promise);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchild.resolve(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reject\",\n\t\t\tvalue: function reject(arg) {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tif (this.state > state.PENDING) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t\tthis.value = arg;\n\t\t\t\tthis.state = state.FAILURE;\n\n\t\t\t\tif (!this.deferred) {\n\t\t\t\t\tthis.deferred = true;\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\t_this.process();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"resolve\",\n\t\t\tvalue: function resolve(arg) {\n\t\t\t\tvar _this2 = this;\n\n\t\t\t\tif (this.state > state.PENDING) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t\tthis.value = arg;\n\t\t\t\tthis.state = state.SUCCESS;\n\n\t\t\t\tif (!this.deferred) {\n\t\t\t\t\tthis.deferred = true;\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\t_this2.process();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"then\",\n\t\t\tvalue: function then(success, failure) {\n\t\t\t\tvar _this3 = this;\n\n\t\t\t\tvar child = new Promise();\n\n\t\t\t\tthis.handlers.push({ success: success, failure: failure, promise: child });\n\n\t\t\t\tif (this.state > state.PENDING && !this.deferred) {\n\t\t\t\t\tthis.deferred = true;\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\t_this3.process();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}]);\n\n\t\treturn Promise;\n\t})();\n\n\t/**\r\n  * @class Deferred\r\n  * @private\r\n  */\n\n\tvar Deferred = (function () {\n\t\tfunction Deferred() {\n\t\t\t_classCallCheck(this, Deferred);\n\n\t\t\tthis.promise = promise();\n\t\t\tthis.onDone = [];\n\t\t\tthis.onAlways = [];\n\t\t\tthis.onFail = [];\n\n\t\t\tthis.bootstrap();\n\t\t}\n\n\t\t_createClass(Deferred, [{\n\t\t\tkey: \"always\",\n\t\t\tvalue: function always(arg) {\n\t\t\t\tif (valid(this, arg)) {\n\t\t\t\t\tthis.onAlways.push(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bootstrap\",\n\t\t\tvalue: function bootstrap() {\n\t\t\t\tvar _this4 = this;\n\n\t\t\t\tthis.promise.then(function (arg) {\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\tvar listeners = [\"onDone\", \"onAlways\"];\n\n\t\t\t\t\t\teach(listeners, function (array) {\n\t\t\t\t\t\t\teach(_this4[array], function (i) {\n\t\t\t\t\t\t\t\ti(arg);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t_this4.reset();\n\t\t\t\t\t});\n\t\t\t\t}, function (e) {\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\tvar listeners = [\"onFail\", \"onAlways\"];\n\n\t\t\t\t\t\teach(listeners, function (array) {\n\t\t\t\t\t\t\teach(_this4[array], function (i) {\n\t\t\t\t\t\t\t\ti(e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t_this4.reset();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"done\",\n\t\t\tvalue: function done(arg) {\n\t\t\t\tif (valid(this, arg)) {\n\t\t\t\t\tthis.onDone.push(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"fail\",\n\t\t\tvalue: function fail(arg) {\n\t\t\t\tif (valid(this, arg)) {\n\t\t\t\t\tthis.onFail.push(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"isRejected\",\n\t\t\tvalue: function isRejected() {\n\t\t\t\treturn this.promise.state === state.FAILURE;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"isResolved\",\n\t\t\tvalue: function isResolved() {\n\t\t\t\treturn this.promise.state === state.SUCCESS;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reject\",\n\t\t\tvalue: function reject(arg) {\n\t\t\t\tthis.promise.reject(arg);\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"resolve\",\n\t\t\tvalue: function resolve(arg) {\n\t\t\t\tthis.promise.resolve(arg);\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {\n\t\t\t\tthis.onAlways = [];\n\t\t\t\tthis.onDone = [];\n\t\t\t\tthis.onFail = [];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"state\",\n\t\t\tvalue: function state() {\n\t\t\t\treturn this.promise.state;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"then\",\n\t\t\tvalue: function then(success, failure) {\n\t\t\t\treturn this.promise.then(success, failure);\n\t\t\t}\n\t\t}]);\n\n\t\treturn Deferred;\n\t})();\n\n\tdeferred = function () {\n\t\treturn new Deferred();\n\t};\n\n\tdeferred.when = function () {\n\t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\targs[_key] = arguments[_key];\n\t\t}\n\n\t\tvar defer = deferred(),\n\t\t    i = 0,\n\t\t    nth;\n\n\t\t// Did we receive an Array? if so it overrides any other arguments\n\t\tif (args[0] instanceof Array) {\n\t\t\targs = args[0];\n\t\t}\n\n\t\tnth = args.length;\n\n\t\tif (nth === 0) {\n\t\t\tdefer.resolve(null);\n\t\t} else {\n\t\t\teach(args, function (p) {\n\t\t\t\tp.then(function () {\n\t\t\t\t\tif (++i === nth && !defer.isResolved()) {\n\t\t\t\t\t\tif (args.length > 1) {\n\t\t\t\t\t\t\tdefer.resolve(args.map(function (obj) {\n\t\t\t\t\t\t\t\treturn obj.value || obj.promise.value;\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdefer.resolve(args[0].value || args[0].promise.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, function () {\n\t\t\t\t\tif (!defer.isResolved()) {\n\t\t\t\t\t\tif (args.length > 1) {\n\t\t\t\t\t\t\tdefer.reject(args.map(function (obj) {\n\t\t\t\t\t\t\t\treturn obj.value || obj.promise.value;\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdefer.reject(args[0].value || args[0].promise.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn defer;\n\t};\n\n\tpromise = function () {\n\t\treturn new Promise();\n\t};\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = deferred;\n\t} else if (typeof define === \"function\") {\n\t\tdefine(function () {\n\t\t\treturn deferred;\n\t\t});\n\t} else {\n\t\tglobal.assure = deferred;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}