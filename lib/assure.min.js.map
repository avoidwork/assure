{"version":3,"sources":["assure.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","each","obj","fn","nth","call","pipe","parent","child","then","arg","resolve","e","reject","reset","onAlways","onDone","onFail","valid","isResolved","isRejected","deferred","undefined","promise","delay","process","nextTick","setImmediate","setTimeout","state","PENDING","FAILURE","SUCCESS","Promise","this","handlers","value","success","slice","callback","result","_this","_this2","failure","_this3","push","Deferred","bootstrap","_this4","array","when","_len","arguments","args","Array","_key","defer","p","map","exports","module","define","assure","window"],"mappings":"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","file":"assure.min.js","sourcesContent":["\"use strict\";\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * assure\r\n *\r\n * @copyright 2015 Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @license BSD-3-Clause\r\n * @link http://avoidwork.github.io/assure/\r\n * @version 1.1.0\r\n */\n(function (global) {\n\tvar deferred = undefined,\n\t    promise = undefined;\n\n\tvar delay = (function () {\n\t\tif (typeof process !== \"undefined\") {\n\t\t\treturn process.nextTick;\n\t\t} else if (typeof setImmediate !== \"undefined\") {\n\t\t\treturn setImmediate;\n\t\t} else {\n\t\t\treturn function (arg) {\n\t\t\t\tsetTimeout(arg, 0);\n\t\t\t};\n\t\t}\n\t})();\n\n\tfunction each(obj, fn) {\n\t\tvar nth = obj.length;\n\t\tvar i = -1;\n\n\t\twhile (++i < nth) {\n\t\t\tif (fn.call(obj, obj[i], i) === false) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tfunction pipe(parent, child) {\n\t\treturn parent.then(function (arg) {\n\t\t\tchild.resolve(arg);\n\t\t}, function (e) {\n\t\t\tchild.reject(e);\n\t\t});\n\t}\n\n\tfunction reset(obj) {\n\t\tobj.onAlways = [];\n\t\tobj.onDone = [];\n\t\tobj.onFail = [];\n\t}\n\n\tvar state = {\n\t\tPENDING: 0,\n\t\tFAILURE: 1,\n\t\tSUCCESS: 2\n\t};\n\n\tfunction valid(obj, fn) {\n\t\treturn !obj.isResolved() && !obj.isRejected() && typeof fn === \"function\";\n\t}\n\n\t/**\r\n  * @class Promise\r\n  * @private\r\n  */\n\n\tvar Promise = (function () {\n\t\tfunction Promise() {\n\t\t\t_classCallCheck(this, Promise);\n\n\t\t\tthis.deferred = false;\n\t\t\tthis.handlers = [];\n\t\t\tthis.state = state.PENDING;\n\t\t\tthis.value = null;\n\t\t}\n\n\t\t_createClass(Promise, [{\n\t\t\tkey: \"process\",\n\t\t\tvalue: function process() {\n\t\t\t\tvar success = undefined,\n\t\t\t\t    value = undefined;\n\n\t\t\t\tthis.deferred = false;\n\n\t\t\t\tif (this.state !== state.PENDING) {\n\t\t\t\t\tvalue = this.value;\n\t\t\t\t\tsuccess = this.state === state.SUCCESS;\n\n\t\t\t\t\teach(this.handlers.slice(), function (i) {\n\t\t\t\t\t\tvar callback = i[success ? \"success\" : \"failure\"],\n\t\t\t\t\t\t    child = i.promise,\n\t\t\t\t\t\t    result = undefined;\n\n\t\t\t\t\t\tif (!callback || typeof callback !== \"function\") {\n\t\t\t\t\t\t\tif (value && typeof value.then === \"function\") {\n\t\t\t\t\t\t\t\tpipe(value, child);\n\t\t\t\t\t\t\t} else if (success) {\n\t\t\t\t\t\t\t\tchild.resolve(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.reject(value);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresult = callback(value);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tchild.reject(e);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (result && typeof result.then === \"function\") {\n\t\t\t\t\t\t\tpipe(result, promise);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchild.resolve(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reject\",\n\t\t\tvalue: function reject(arg) {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tif (this.state > state.PENDING) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t\tthis.value = arg;\n\t\t\t\tthis.state = state.FAILURE;\n\n\t\t\t\tif (!this.deferred) {\n\t\t\t\t\tthis.deferred = true;\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\t_this.process();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"resolve\",\n\t\t\tvalue: function resolve(arg) {\n\t\t\t\tvar _this2 = this;\n\n\t\t\t\tif (this.state > state.PENDING) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t\tthis.value = arg;\n\t\t\t\tthis.state = state.SUCCESS;\n\n\t\t\t\tif (!this.deferred) {\n\t\t\t\t\tthis.deferred = true;\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\t_this2.process();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"then\",\n\t\t\tvalue: function then(success, failure) {\n\t\t\t\tvar _this3 = this;\n\n\t\t\t\tvar child = new Promise();\n\n\t\t\t\tthis.handlers.push({ success: success, failure: failure, promise: child });\n\n\t\t\t\tif (this.state > state.PENDING && !this.deferred) {\n\t\t\t\t\tthis.deferred = true;\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\t_this3.process();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}]);\n\n\t\treturn Promise;\n\t})();\n\n\t/**\r\n  * @class Deferred\r\n  * @private\r\n  */\n\n\tvar Deferred = (function () {\n\t\tfunction Deferred() {\n\t\t\t_classCallCheck(this, Deferred);\n\n\t\t\tthis.promise = promise();\n\t\t\tthis.onDone = [];\n\t\t\tthis.onAlways = [];\n\t\t\tthis.onFail = [];\n\t\t\tthis.bootstrap();\n\t\t}\n\n\t\t_createClass(Deferred, [{\n\t\t\tkey: \"always\",\n\t\t\tvalue: function always(arg) {\n\t\t\t\tif (valid(this, arg)) {\n\t\t\t\t\tthis.onAlways.push(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bootstrap\",\n\t\t\tvalue: function bootstrap() {\n\t\t\t\tvar _this4 = this;\n\n\t\t\t\tthis.promise.then(function (arg) {\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\teach([\"onDone\", \"onAlways\"], function (array) {\n\t\t\t\t\t\t\teach(_this4[array], function (i) {\n\t\t\t\t\t\t\t\ti(arg);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treset(_this4);\n\t\t\t\t\t});\n\t\t\t\t}, function (e) {\n\t\t\t\t\tdelay(function () {\n\t\t\t\t\t\teach([\"onFail\", \"onAlways\"], function (array) {\n\t\t\t\t\t\t\teach(_this4[array], function (i) {\n\t\t\t\t\t\t\t\ti(e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treset(_this4);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"done\",\n\t\t\tvalue: function done(arg) {\n\t\t\t\tif (valid(this, arg)) {\n\t\t\t\t\tthis.onDone.push(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"fail\",\n\t\t\tvalue: function fail(arg) {\n\t\t\t\tif (valid(this, arg)) {\n\t\t\t\t\tthis.onFail.push(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"isRejected\",\n\t\t\tvalue: function isRejected() {\n\t\t\t\treturn this.promise.state === state.FAILURE;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"isResolved\",\n\t\t\tvalue: function isResolved() {\n\t\t\t\treturn this.promise.state === state.SUCCESS;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reject\",\n\t\t\tvalue: function reject(arg) {\n\t\t\t\tthis.promise.reject(arg);\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"resolve\",\n\t\t\tvalue: function resolve(arg) {\n\t\t\t\tthis.promise.resolve(arg);\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"state\",\n\t\t\tvalue: function state() {\n\t\t\t\treturn this.promise.state;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"then\",\n\t\t\tvalue: function then(success, failure) {\n\t\t\t\treturn this.promise.then(success, failure);\n\t\t\t}\n\t\t}]);\n\n\t\treturn Deferred;\n\t})();\n\n\tdeferred = function () {\n\t\treturn new Deferred();\n\t};\n\n\tdeferred.when = function () {\n\t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\targs[_key] = arguments[_key];\n\t\t}\n\n\t\tvar defer = deferred(),\n\t\t    i = 0,\n\t\t    nth;\n\n\t\t// Did we receive an Array? if so it overrides any other arguments\n\t\tif (args[0] instanceof Array) {\n\t\t\targs = args[0];\n\t\t}\n\n\t\tnth = args.length;\n\n\t\tif (nth === 0) {\n\t\t\tdefer.resolve(null);\n\t\t} else {\n\t\t\teach(args, function (p) {\n\t\t\t\tp.then(function () {\n\t\t\t\t\tif (++i === nth && !defer.isResolved()) {\n\t\t\t\t\t\tif (args.length > 1) {\n\t\t\t\t\t\t\tdefer.resolve(args.map(function (obj) {\n\t\t\t\t\t\t\t\treturn obj.value || obj.promise.value;\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdefer.resolve(args[0].value || args[0].promise.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, function () {\n\t\t\t\t\tif (!defer.isResolved()) {\n\t\t\t\t\t\tif (args.length > 1) {\n\t\t\t\t\t\t\tdefer.reject(args.map(function (obj) {\n\t\t\t\t\t\t\t\treturn obj.value || obj.promise.value;\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdefer.reject(args[0].value || args[0].promise.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn defer;\n\t};\n\n\tpromise = function () {\n\t\treturn new Promise();\n\t};\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = deferred;\n\t} else if (typeof define === \"function\") {\n\t\tdefine(function () {\n\t\t\treturn deferred;\n\t\t});\n\t} else {\n\t\tglobal.assure = deferred;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}